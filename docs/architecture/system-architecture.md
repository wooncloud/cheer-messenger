# ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

Cheer Messengerì˜ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ì™€ ê¸°ìˆ ì  ì„¤ê³„ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client        â”‚    â”‚   SvelteKit     â”‚    â”‚   Supabase      â”‚
â”‚   (Browser)     â”‚â—„â”€â”€â–ºâ”‚   Frontend      â”‚â—„â”€â”€â–ºâ”‚   Backend       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI Components â”‚    â”‚   Server Actionsâ”‚    â”‚   Database      â”‚
â”‚   Svelte/TS     â”‚    â”‚   API Routes    â”‚    â”‚   PostgreSQL    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ ì•„í‚¤í…ì²˜ ì›ì¹™

### 1. **í”„ë¡ íŠ¸ì—”ë“œ ì¤‘ì‹¬ ì„¤ê³„**
- SvelteKitì˜ í’€ìŠ¤íƒ ê¸°ëŠ¥ í™œìš©
- SSR/SPA í•˜ì´ë¸Œë¦¬ë“œ ë Œë”ë§
- ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ëª¨ë“ˆí™”

### 2. **Backend-as-a-Service**
- Supabaseë¥¼ í†µí•œ ì„œë²„ë¦¬ìŠ¤ ë°±ì—”ë“œ
- ì‹¤ì‹œê°„ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ë…
- ìë™ API ìƒì„±

### 3. **ë³´ì•ˆ ìš°ì„  ì„¤ê³„**
- Row Level Security (RLS) ì •ì±…
- í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ê²€ì¦ ì´ì¤‘í™”
- JWT ê¸°ë°˜ ì¸ì¦

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### Frontend
```typescript
â”œâ”€â”€ SvelteKit 2.0      // í’€ìŠ¤íƒ í”„ë ˆì„ì›Œí¬
â”œâ”€â”€ TypeScript         // íƒ€ì… ì•ˆì „ì„±
â”œâ”€â”€ Tailwind CSS       // ìœ í‹¸ë¦¬í‹° CSS
â””â”€â”€ Vite              // ë¹Œë“œ ë„êµ¬
```

### Backend
```typescript
â”œâ”€â”€ Supabase          // BaaS í”Œë«í¼
â”œâ”€â”€ PostgreSQL        // ë°ì´í„°ë² ì´ìŠ¤
â”œâ”€â”€ PostgREST         // ìë™ API ìƒì„±
â””â”€â”€ GoTrue            // ì¸ì¦ ì„œë¹„ìŠ¤
```

### DevOps
```typescript
â”œâ”€â”€ Vercel            // ë°°í¬ í”Œë«í¼
â”œâ”€â”€ GitHub Actions    // CI/CD (ì„ íƒ)
â””â”€â”€ ESLint/Prettier   // ì½”ë“œ í’ˆì§ˆ
```

## ğŸ“Š ë°ì´í„° íë¦„

### ì¸ì¦ í”Œë¡œìš°
```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant S as SvelteKit
    participant G as Google OAuth
    participant SB as Supabase

    U->>C: ë¡œê·¸ì¸ í´ë¦­
    C->>S: OAuth ìš”ì²­
    S->>G: Google ì¸ì¦ ë¦¬ë‹¤ì´ë ‰íŠ¸
    G->>U: ë¡œê·¸ì¸ í¼ í‘œì‹œ
    U->>G: ì¸ì¦ ì •ë³´ ì…ë ¥
    G->>S: ì¸ì¦ ì½”ë“œ ë°˜í™˜
    S->>SB: ì½”ë“œë¡œ í† í° êµí™˜
    SB->>S: JWT í† í° ë°˜í™˜
    S->>C: ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •
    C->>U: ëŒ€ì‹œë³´ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸
```

### ì¹­ì°¬ ì „ì†¡ í”Œë¡œìš°
```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant S as SvelteKit
    participant SB as Supabase
    participant DB as Database

    U->>C: ì¹­ì°¬ ì‘ì„±
    C->>S: ì¹­ì°¬ ë°ì´í„° ì „ì†¡
    S->>SB: ì¿¨íƒ€ì„ ê²€ì¦ í•¨ìˆ˜ í˜¸ì¶œ
    SB->>DB: can_praise_user() ì‹¤í–‰
    DB->>SB: ê²€ì¦ ê²°ê³¼ ë°˜í™˜
    
    alt ì¿¨íƒ€ì„ í†µê³¼
        SB->>DB: praise_messages INSERT
        DB->>SB: ì¹­ì°¬ ìƒì„± ì™„ë£Œ
        SB->>DB: praise_cooldowns UPDATE
        SB->>S: ì„±ê³µ ì‘ë‹µ
        S->>C: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
    else ì¿¨íƒ€ì„ ë¯¸í†µê³¼
        SB->>S: ì˜¤ë¥˜ ì‘ë‹µ
        S->>C: ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
    end
```

## ğŸ›ï¸ ë ˆì´ì–´ êµ¬ì¡°

### 1. Presentation Layer (í”„ë ˆì  í…Œì´ì…˜ ì¸µ)
```
src/lib/components/
â”œâ”€â”€ common/           # ê³µí†µ UI ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ dashboard/        # ëŒ€ì‹œë³´ë“œ ê´€ë ¨
â”œâ”€â”€ group/           # ëª¨ì„ ê´€ë ¨
â”œâ”€â”€ create-group/    # ëª¨ì„ ìƒì„±
â”œâ”€â”€ invite/          # ì´ˆëŒ€ ê´€ë ¨
â””â”€â”€ settings/        # ì„¤ì • ê´€ë ¨
```

**ì—­í• **:
- ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ë Œë”ë§
- ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬
- ìƒíƒœ ê´€ë¦¬ (Svelte stores)

### 2. Business Logic Layer (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¸µ)
```
src/lib/utils/
â”œâ”€â”€ auth.ts          # ì¸ì¦ ê´€ë ¨ ë¡œì§
â”œâ”€â”€ groups.ts        # ëª¨ì„ ê´€ë¦¬ ë¡œì§
â”œâ”€â”€ members.ts       # ë©¤ë²„ ê´€ë¦¬ ë¡œì§
â””â”€â”€ praise.ts        # ì¹­ì°¬ ì‹œìŠ¤í…œ ë¡œì§
```

**ì—­í• **:
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ êµ¬í˜„
- ë°ì´í„° ë³€í™˜ ë° ìœ íš¨ì„± ê²€ì‚¬
- API í˜¸ì¶œ ì¶”ìƒí™”

### 3. Data Access Layer (ë°ì´í„° ì ‘ê·¼ ì¸µ)
```
src/lib/
â”œâ”€â”€ supabase.ts      # Supabase í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ database.types.ts # íƒ€ì… ì •ì˜
â””â”€â”€ stores/          # ìƒíƒœ ê´€ë¦¬
```

**ì—­í• **:
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
- íƒ€ì… ì•ˆì „ì„± ë³´ì¥
- ì‹¤ì‹œê°„ êµ¬ë… ê´€ë¦¬

### 4. Database Layer (ë°ì´í„°ë² ì´ìŠ¤ ì¸µ)
```sql
-- í•µì‹¬ í…Œì´ë¸”
users              # ì‚¬ìš©ì ì •ë³´
groups             # ëª¨ì„ ì •ë³´
group_members      # ë©¤ë²„ì‹­ ê´€ê³„
praise_messages    # ì¹­ì°¬ ë©”ì‹œì§€
praise_cooldowns   # ì¿¨íƒ€ì„ ì¶”ì 
```

**ì—­í• **:
- ë°ì´í„° ì˜ì†ì„±
- ë¬´ê²°ì„± ì œì•½ì¡°ê±´
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (í•¨ìˆ˜/íŠ¸ë¦¬ê±°)

## ğŸ” ë³´ì•ˆ ì•„í‚¤í…ì²˜

### ì¸ì¦ ì²´ê³„
```
Google OAuth 2.0 â†’ Supabase Auth â†’ JWT Token â†’ RLS Policy
```

### RLS ì •ì±… êµ¬ì¡°
```sql
-- ì‚¬ìš©ìë³„ ë°ì´í„° ê²©ë¦¬
users: auth.uid() = id

-- ëª¨ì„ë³„ ë°ì´í„° ì ‘ê·¼ ì œí•œ
groups: EXISTS(SELECT 1 FROM group_members WHERE user_id = auth.uid())

-- ì¹­ì°¬ ë©”ì‹œì§€ ì ‘ê·¼ ì œì–´
praise_messages: ëª¨ì„ ë©¤ë²„ë§Œ ì¡°íšŒ/ìƒì„± ê°€ëŠ¥
```

### ë°ì´í„° ë³´í˜¸ ì „ëµ

1. **í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê²€ì¦**: ì¦‰ì‹œ í”¼ë“œë°±
2. **ì„œë²„ ì¸¡ ê²€ì¦**: ë³´ì•ˆ ë³´ì¥
3. **ë°ì´í„°ë² ì´ìŠ¤ ì œì•½**: ìµœì¢… ë°©ì–´ì„ 

## ğŸ“ˆ í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### ì„±ëŠ¥ ìµœì í™”
- **Database Indexing**: ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒ
- **Connection Pooling**: Supabase ìë™ ê´€ë¦¬
- **CDN**: Vercel Edge Network
- **Image Optimization**: ìë™ ì••ì¶•/ë³€í™˜

### ëª¨ë‹ˆí„°ë§ ì „ëµ
- **Real-time Logs**: Supabase ëŒ€ì‹œë³´ë“œ
- **Error Tracking**: ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬
- **Performance Metrics**: Core Web Vitals

### í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°
```
í˜„ì¬: Single-tenant (ëª¨ì„ë³„ ê²©ë¦¬)
í™•ì¥: Multi-tenant (ì¡°ì§ë³„ ê²©ë¦¬)
ê¸€ë¡œë²Œ: Regionë³„ ë°ì´í„°ë² ì´ìŠ¤
```

## ğŸš€ ë°°í¬ ì•„í‚¤í…ì²˜

### Vercel ë°°í¬ êµ¬ì¡°
```
GitHub Repository â†’ Vercel Build â†’ Edge Deployment
                  â†“
                Supabase Database (Regional)
```

### í™˜ê²½ë³„ êµ¬ì„±
- **Development**: ë¡œì»¬ + Supabase Dev
- **Staging**: Vercel Preview + Supabase Staging
- **Production**: Vercel Production + Supabase Production

## ğŸ”„ ì‹¤ì‹œê°„ ê¸°ëŠ¥

### Supabase Realtime
```typescript
// ì‹¤ì‹œê°„ ì¹­ì°¬ ëª©ë¡ ì—…ë°ì´íŠ¸
supabase
  .channel('praise_messages')
  .on('postgres_changes', {
    event: '*',
    schema: 'public',
    table: 'praise_messages'
  }, handlePraiseUpdate)
  .subscribe()
```

### ë°ì´í„° ë™ê¸°í™” ì „ëµ
1. **Optimistic Updates**: ì¦‰ì‹œ UI ë°˜ì˜
2. **Real-time Sync**: ì„œë²„ ë³€ê²½ì‚¬í•­ êµ¬ë…
3. **Conflict Resolution**: ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ìš°ì„ 

---

ì´ ì•„í‚¤í…ì²˜ëŠ” **ë‹¨ìˆœí•¨**, **í™•ì¥ì„±**, **ë³´ì•ˆì„±**ì˜ ê· í˜•ì„ ì¶”êµ¬í•˜ë©°, íŒ€ì˜ ê°œë°œ ìƒì‚°ì„±ê³¼ ì‚¬ìš©ì ê²½í—˜ì„ ìµœìš°ì„ ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.